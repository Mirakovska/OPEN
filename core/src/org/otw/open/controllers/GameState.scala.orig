package org.otw.open.controllers

import com.badlogic.gdx.Gdx
import org.otw.open.dto.Theme

import org.json4s._
import org.json4s.jackson.JsonMethods._

import scala.RuntimeException

/**
  * Created by eilievska on 2/18/2016.
  */
object GameState {

  private var themeName: String = "car_theme"

<<<<<<< HEAD
  private var level = 1
=======
  private var level = 3

  def getLevelStandPoints = {
    val theme: Theme = themeMap.get(themeName).orElse(throw new RuntimeException).get
    theme.levels.get(level.toString).get
  }

  def getLevelStartPoint = {
    val theme: Theme = themeMap.get(themeName).orElse(throw new RuntimeException).get
    theme.start_point
  }
>>>>>>> d2fb09f6ddc103965e239d5040ca0b8194b6a0d9

  private val jsonString: String = getStringFromJsonFile

  implicit val formats = org.json4s.DefaultFormats
<<<<<<< HEAD
  private val themeMap: Map[String, Theme] = parse(jsonString).extract[Map[String, Theme]]
=======
  val themeMap: Map[String, Theme] = parse(jsonString).extract[Map[String, Theme]]
>>>>>>> d2fb09f6ddc103965e239d5040ca0b8194b6a0d9

  private def getStringFromJsonFile: String = {
    val inputStream = Gdx.files.internal("cause_and_effect.json").read()
    val jsonString: String = scala.io.Source.fromInputStream(inputStream).getLines().mkString(" ")
    jsonString
  }

<<<<<<< HEAD
  def getLevelStandPoints = {
    val theme: Theme = themeMap.get(themeName).orNull
    theme.levels.get(level.toString).get
  }

  def getLevelStartPoint = {
    val theme: Theme = themeMap.get(themeName).orNull
    theme.start_point
  }

=======
>>>>>>> d2fb09f6ddc103965e239d5040ca0b8194b6a0d9
  def getThemeName = themeName

  def getLevel = level

<<<<<<< HEAD
  def incrementLevel = if (level == 4) level = 1 else level += 1

  def nextTheme = {
    themeName = themeMap.keys.toList match {
      case themeMap :: x :: _ => x
      case _ => themeName
    }
    setLevel(1)
  }

  def setLevel(newLevel: Int) = {
    if (newLevel > 0 && newLevel < 5)
      level = newLevel
  }

=======
>>>>>>> d2fb09f6ddc103965e239d5040ca0b8194b6a0d9
}
